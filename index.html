<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Reserva de Aniversário • Mercatto Delícia</title>
  <meta name="description" content="Página de reservas de aniversário com envio para planilha do Google e botão de falar com atendente pelo WhatsApp.">
  <style>
    :root{
      --bg:#0a0a0a;        /* fundo escuro do pôster */
      --panel:#111214;      /* cartões */
      --line:#292929;       /* bordas sutis */
      --text:#f8f7f4;       /* texto claro */
      --muted:#cfc8b0;      /* texto secundário com tom quente */
      --brand:#d4af37;      /* dourado (ouro) do pôster */
      --brand-2:#f5d26a;    /* dourado claro para realces */
      --ok:#16a34a; --danger:#ef4444;
    }

    *{box-sizing:border-box}
    html,body{margin:0;background:linear-gradient(180deg,#0b0b0c, #0a0a0a 60%);color:var(--text);font-family:system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif}
    a{color:inherit}

    /* Layout base */
    .container{max-width:980px;margin:0 auto;padding:16px}

    /* HERO */
    .hero{position:relative;border-bottom:1px solid #1a1a1a;overflow:hidden}
    .hero img{width:100%;height:320px;object-fit:cover;filter:brightness(.65) contrast(1.05)}
    .hero .overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:24px;background:linear-gradient(180deg,rgba(0,0,0,.35),rgba(0,0,0,.55))}
    .hero h1{margin:0;text-align:center;line-height:1.15;font-weight:800;letter-spacing:.5px}
    .hero .title{font-size:clamp(24px,5.6vw,48px)}
    .hero .subtitle{font-size:clamp(14px,3.2vw,18px);opacity:.95;margin-top:8px;color:var(--brand-2)}

    /* CARD */
    .card{background:rgba(17,18,20,.84);backdrop-filter:saturate(120%) blur(4px);border:1px solid #1f1f1f;border-radius:18px;padding:16px}
    .card + .card{margin-top:12px}

    /* Labels dourados */
    .kicker{display:inline-flex;gap.6rem;align-items:center;font-weight:700;color:#0b0b0c;background:var(--brand);padding:6px 10px;border-radius:999px;text-transform:uppercase;letter-spacing:.6px;font-size:12px}

    /* Form */
    form{display:grid;gap:12px}
    label{font-size:12px;color:var(--muted)}
    input,select,textarea,button{font:inherit}
    input,select,textarea{width:100%;background:#0c0d0f;border:1px solid var(--line);color:var(--text);padding:12px;border-radius:12px;outline:none}
    input:focus,select:focus,textarea:focus{border-color:var(--brand);box-shadow:0 0 0 2px rgba(212,175,55,.18)}
    textarea{min-height:96px;resize:vertical}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .row-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
    @media (max-width:860px){.row,.row-3{grid-template-columns:1fr}}

    .hint{font-size:12px;color:var(--muted);opacity:.85;margin-top:4px}

    /* Botões */
    .btn{cursor:pointer;border:0;border-radius:999px;padding:14px 18px;font-weight:800;letter-spacing:.3px}
    .btn-primary{background:linear-gradient(180deg,var(--brand),#c79b1d);color:#1a1500;border:1px solid #d0a62d}
    .btn-line{background:transparent;border:1px solid var(--line);color:var(--text)}
    .btn:disabled{opacity:.6;cursor:not-allowed}

    /* CTA sticky em mobile */
    .sticky-cta{position:sticky;bottom:0;left:0;right:0;background:linear-gradient(180deg,rgba(10,10,10,.05),rgba(10,10,10,.8));backdrop-filter:blur(6px);padding:12px;border-top:1px solid #1a1a1a;display:flex;gap:10px}

    /* Seções */
    .section-title{font-size:18px;font-weight:800;margin:6px 0 12px 0;letter-spacing:.2px}

    /* Tabelinhas */
    .grid-two{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media (max-width:860px){.grid-two{grid-template-columns:1fr}}

    /* Alerta/sucesso */
    .note{font-size:13px;color:var(--muted)}
    .success{border:1px solid rgba(22,163,74,.35);background:rgba(22,163,74,.08);color:#c7f7d4;padding:12px;border-radius:10px}
    .error{border:1px solid rgba(239,68,68,.35);background:rgba(239,68,68,.08);color:#ffd5d5;padding:12px;border-radius:10px}

    /* Footer */
    footer{color:var(--muted);font-size:12px;padding:24px 16px;text-align:center}
  </style>
</head>
<body>
  <header class="hero">
    <!-- Troque a URL abaixo pela sua imagem oficial -->
    <img id="heroImg" src="https://github.com/ClenaStore/aniversarios/raw/main/pages/api/Imagem%20do%20WhatsApp%20de%202025-08-27%20%C3%A0(s)%2010.13.55_d0cbe205.jpg" alt="Banner Aniversário Mercatto Delícia" />
    <div class="overlay">
      <div class="container" style="text-align:center">
        <span class="kicker">Aniversário</span>
        <h1 class="title">Comemore com <span style="color:var(--brand)">benefícios</span> especiais</h1>
        <div class="subtitle">Ganhe até <b>R$ 100</b> de desconto conforme o consumo</div>
      </div>
    </div>
  </header>

  <main class="container" id="app">
    <section class="card">
      <div class="section-title">Faça sua reserva</div>
      <form id="formReserva">
        <div class="row">
          <div>
            <label>Nome completo</label>
            <input id="nome" placeholder="Seu nome" required />
          </div>
          <div>
            <label>Email</label>
            <input id="email" type="email" placeholder="seu@email.com" />
          </div>
        </div>
        <div class="row">
          <div>
            <label>Telefone (com DDD)</label>
            <input id="telefone" inputmode="tel" placeholder="(99) 99999-9999" required />
            <div class="hint">Usaremos para confirmar sua reserva.</div>
          </div>
          <div>
            <label>Quantidade de pessoas</label>
            <select id="pessoas" required>
              <option value="">Selecione…</option>
              <option>1</option><option>2</option><option>3</option><option>4</option>
              <option>5</option><option>6</option><option>7</option><option>8</option>
              <option>9</option><option>10</option><option>11</option><option>12</option>
              <option>13</option><option>14</option><option>15</option>
            </select>
          </div>
        </div>
        <div class="row-3">
          <div>
            <label>Data</label>
            <input id="data" type="date" required />
          </div>
          <div>
            <label>Hora</label>
            <input id="hora" type="time" required />
          </div>
          <div>
            <label>Nº da mesa (opcional)</label>
            <input id="mesa" placeholder="ex.: 12" />
          </div>
        </div>
        <div>
          <label>Observações (opcional)</label>
          <textarea id="observacoes" placeholder="Ex.: Preferência por mesa externa, levar bolo, etc."></textarea>
        </div>
        <div class="grid-two">
          <button id="btnReservar" class="btn btn-primary" type="submit">Reservar agora</button>
          <a id="btnAtendente" class="btn btn-line" href="#" target="_blank" rel="noopener">Falar com atendente</a>
        </div>
        <div id="msg" style="margin-top:10px"></div>
      </form>
    </section>

    <section class="card">
      <div class="section-title">Regras</div>
      <p class="note">Válido apenas no mês do aniversário (com documento). Exclusivo para consumo no local. Um benefício por aniversariante. Desconto aplicado em múltiplos de R$ 20 até o limite de R$ 100.</p>
    </section>
  </main>

  <div class="sticky-cta container">
    <button class="btn btn-primary" id="ctaReservar">Reservar</button>
    <a id="ctaAtendente" class="btn btn-line" href="#" target="_blank" rel="noopener">Atendente</a>
  </div>

  <footer>Mercatto Delícia • © <span id="year"></span></footer>

<script>
  /* =================== CONFIG =================== */
  const CONFIG = {
    SHEET_ENDPOINT: "https://script.google.com/macros/s/SEU_SCRIPT_ID/exec", // <- troque pelo seu URL do Apps Script (doGet/doPost)
    ATENDENTE_WHATS: "5599999999999", // <- número com DDI+DDD
    ATENDENTE_MSG: "Olá! Gostaria de falar com um atendente sobre reserva de aniversário.",
    EMPRESA: "MERCATTO DELÍCIA"
  };

  /* ===== Utilitários ===== */
  const $ = sel => document.querySelector(sel);
  function normalizePhoneBR(p){
    let raw = String(p||'').replace(/\D+/g,'');
    if (!raw) return '';
    raw = raw.replace(/^0+/, '');
    if (!raw.startsWith('55')) raw = '55' + raw;
    if (raw.length===12){ const ddd = raw.slice(2,4); const local = raw.slice(4); raw = '55'+ddd+'9'+local; }
    return raw;
  }
  function ensureHttp(u){ return /^https?:\/\//i.test(u)?u:(u?('https://'+u):''); }
  function buildWhatsLink(phoneDigits, text){
    const encoded = encodeURIComponent(text).replace(/%0D%0A|%0D/g, '%0A');
    const ua = navigator.userAgent||'';
    const isMobile = /Android|iPhone|iPad|iPod|Mobile|WhatsApp/i.test(ua);
    if (isMobile) return `whatsapp://send?phone=${phoneDigits}&text=${encoded}`;
    return `https://web.whatsapp.com/send?phone=${phoneDigits}&text=${encoded}`;
  }

  /* ===== Inicialização ===== */
  $('#year').textContent = new Date().getFullYear();

  // Botões de atendente
  function refreshAttendantLinks(){
    const phone = normalizePhoneBR(CONFIG.ATENDENTE_WHATS);
    const text = CONFIG.ATENDENTE_MSG;
    const link = buildWhatsLink(phone, text);
    $('#btnAtendente').href = link;
    $('#ctaAtendente').href = link;
  }
  refreshAttendantLinks();

  $('#ctaReservar').addEventListener('click', ()=> { document.getElementById('nome').focus(); window.scrollTo({top:document.getElementById('formReserva').offsetTop-16, behavior:'smooth'}); });

  /* ===== Envio ===== */
  $('#formReserva').addEventListener('submit', async (ev)=>{
    ev.preventDefault();
    const btn = $('#btnReservar');
    const msg = $('#msg'); msg.textContent=''; msg.className='';

    // Coleta
    const nome = $('#nome').value.trim();
    const email = $('#email').value.trim();
    const telefone = normalizePhoneBR($('#telefone').value);
    const pessoas = $('#pessoas').value.trim();
    const mesa = $('#mesa').value.trim();
    const data = $('#data').value; // yyyy-mm-dd
    const hora = $('#hora').value; // HH:MM
    const observacoes = $('#observacoes').value.trim();

    if (!nome || !telefone || !pessoas || !data || !hora){
      msg.textContent = 'Preencha os campos obrigatórios.';
      msg.className = 'error';
      return;
    }

    const id = 'R'+Date.now().toString(36)+Math.random().toString(36).slice(2,7).toUpperCase();
    const carimbo = new Date().toISOString();
    const dataHoraISO = new Date(`${data}T${hora}:00`).toISOString();

    // Monta o objeto obedecendo a ORDEM pedida e PULANDO colunas ignoradas
    const payload = {
      ID: id,
      Carimbo: carimbo,
      Nome: nome,
      Email: email,
      Telefone: telefone,
      Pessoas: pessoas,
      Mesa: mesa,
      DataHora: dataHoraISO,
      Status: 'Pendente',
      Observacoes: observacoes
    };

    btn.disabled = true; btn.textContent = 'Enviando…';
    try{
      const r = await fetch(CONFIG.SHEET_ENDPOINT,{
        method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(payload)
      });
      const ok = r.ok; let data; try{ data = await r.json(); }catch{ }

      if (ok){
        msg.innerHTML = `<div class="success"><b>Reserva enviada!</b><br>Seu protocolo: <b>${id}</b>. Entraremos em contato para confirmar.</div>`;
        // limpa
        $('#formReserva').reset();
      }else{
        throw new Error((data&&data.error)||'Falha ao enviar');
      }
    }catch(err){
      console.error(err);
      msg.innerHTML = `<div class="error">Não foi possível enviar sua reserva agora. Tente novamente em instantes.</div>`;
    }finally{
      btn.disabled = false; btn.textContent = 'Reservar agora';
    }
  });
</script>

<!-- =================== APPS SCRIPT (cole em um projeto no Google Apps Script) ===================
function doPost(e){
  try{
    const ss = SpreadsheetApp.openById('SUA_SHEET_ID'); // <- troque aqui
    const sheet = ss.getSheetByName('Reservas') || ss.getSheets()[0];
    const data = JSON.parse(e.postData.contents);
    // Cabeçalho da planilha: 
    // ID, Carimbo, Nome, Email, Telefone, Pessoas, Mesa, Cardapio, DataHora, ValorEstimado, PagamentoAntecipado, Banco, ValorFinalPago, Status, Observacoes, NomeArquivo, ArquivoURL
    // Pediram para IGNORAR: Cardapio, ValorEstimado, PagamentoAntecipado, Banco, ValorFinalPago, NomeArquivo, ArquivoURL

    const row = [
      data.ID || '',
      data.Carimbo || new Date().toISOString(),
      data.Nome || '',
      data.Email || '',
      data.Telefone || '',
      data.Pessoas || '',
      data.Mesa || '',
      '', // Cardapio (ignorado)
      data.DataHora || '',
      '', // ValorEstimado (ignorado)
      '', // PagamentoAntecipado (ignorado)
      '', // Banco (ignorado)
      '', // ValorFinalPago (ignorado)
      data.Status || 'Pendente',
      data.Observacoes || '',
      '', // NomeArquivo (ignorado)
      ''  // ArquivoURL (ignorado)
    ];

    sheet.appendRow(row);
    return ContentService.createTextOutput(JSON.stringify({ok:true,id:data.ID}))
      .setMimeType(ContentService.MimeType.JSON);
  }catch(err){
    return ContentService.createTextOutput(JSON.stringify({ok:false,error:String(err)}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
-->
</body>
</html>
